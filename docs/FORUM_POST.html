<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeMap - Floor Plan Visualization for HC3</title>
</head>
<body>
    <button id="copyBtn" onclick="copyToClipboard()" style="position: fixed; top: 10px; right: 10px; padding: 10px 20px; font-size: 16px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px;">
        Copy Forum Post
    </button>
    
    <div id="content">
<h1>üè† HomeMap</h1>
<p class="subtitle">Visual Floor Plan Interface for Fibaro Home Center 3</p>

<p>
<span class="badge badge-blue">Release</span>
<span class="badge badge-green">MIT License</span>
</p>

<h2>Overview</h2>
<p>HomeMap is a desktop application for visualizing and controlling your Fibaro Home Center 3 (HC3) home automation system using interactive floor plans.</p>

<hr>

<h2>‚ú® Features</h2>
<ul>
<li><strong>üìç Interactive Floor Plans</strong> - Display devices on custom floor plan images</li>
<li><strong>üîÑ Real-time Updates</strong> - Live device status using HC3 event polling</li>
<li><strong>üé® Flexible Widget System</strong> - JSON-based device definitions with built-in widgets</li>
<li><strong>‚úèÔ∏è Edit Mode</strong> - Drag-and-drop device positioning with auto-save</li>
<li><strong>üñºÔ∏è Floor Management</strong> - Add/edit/delete floors via UI with image preview</li>
<li><strong>üì± Device Management</strong> - Install/uninstall devices with visual side panel</li>
<li><strong>‚öôÔ∏è Settings Dialog</strong> - Configure HC3, house name, floors - all from the UI</li>
<li><strong>üè∑Ô∏è Multiple Device Types</strong> - Lights, dimmers, temperature sensors, motion sensors, and more</li>
<li><strong>‚ö° Fast Event Handling</strong> - Dispatch table architecture for O(1) event processing</li>
<li><strong>üîß DevTools</strong> - Built-in developer tools (Cmd+Shift+I)</li>
<li><strong>üîÑ Auto-Updates</strong> - Automatic update checking and installation</li>
<li><strong>üéØ Multi-Floor Support</strong> - Tab-based navigation between floors</li>
<li><strong>üìÅ Zero Configuration</strong> - Works out of the box, auto-creates needed folders</li>
</ul>

<hr>

<h2>üì• Installation</h2>

<h3>Download</h3>
<p>Download the latest release for your platform from the <a href="https://github.com/jangabrielsson/HomeMap/releases">Releases</a> page:</p>

<p><strong>macOS</strong></p>
<ul>
<li>Apple Silicon (M1/M2/M3): <code>HomeMap_*_aarch64.dmg</code></li>
<li>Intel: <code>HomeMap_*_x64.dmg</code></li>
</ul>

<p><strong>Windows:</strong> <code>HomeMap_*_x64-setup.exe</code></p>

<h3>First Run</h3>

<p><strong>macOS:</strong></p>
<ol>
<li>Open the DMG and drag HomeMap to Applications</li>
<li>Right-click the app and select "Open" (first time only)</li>
<li>If blocked, go to System Preferences ‚Üí Security &amp; Privacy ‚Üí "Open Anyway"</li>
</ol>

<p><strong>Windows:</strong></p>
<ol>
<li>Run the installer</li>
<li>If Windows Defender blocks it, click "More info" ‚Üí "Run anyway"</li>
<li>App is safe but not signed with a Microsoft certificate</li>
</ol>

<h3>Quick Setup</h3>

<p>HomeMap is designed to work out of the box! On first launch:</p>

<p><strong>1. Automatic Setup</strong></p>
<ul>
<li>The app automatically creates a configuration folder</li>
<li>All required files and built-in widgets are installed automatically</li>
<li>No manual folder creation needed!</li>
</ul>

<p><strong>2. Configure HC3 Connection</strong></p>
<ul>
<li>Click the Settings button (‚öôÔ∏è) in the top-right corner</li>
<li>Enter your HC3 credentials:
  <ul>
    <li>IP Address or Hostname</li>
    <li>Username</li>
    <li>Password</li>
    <li>Protocol (http or https)</li>
  </ul>
</li>
<li>Optionally: Set your house name and icon (emoji)</li>
</ul>

<p><strong>3. Set Up Your Floor Plans</strong></p>
<ul>
<li>Click the Settings button (‚öôÔ∏è) ‚Üí Floors tab</li>
<li>Add floors by selecting floor plan images</li>
<li>The app automatically detects dimensions and maintains aspect ratios</li>
<li>Arrange floors with Move Up/Down buttons</li>
</ul>

<p><strong>4. Add Your Devices</strong></p>
<ul>
<li>Turn on Edit Mode (toggle in top bar)</li>
<li>Open the Device Management panel (‚ò∞ button)</li>
<li>Select devices from your HC3 system</li>
<li>Choose widget type and floor for each device</li>
<li>Click Install to add devices to your floor plan</li>
<li>Drag devices to position them on your floor plan</li>
</ul>

<p><strong>That's it!</strong> No manual file editing required. The app handles all configuration through its UI.</p>

<p><strong>Advanced: Custom .env Configuration (Optional)</strong></p>
<p>For development or if you prefer environment variables, create a <code>.env</code> file in your home directory:</p>
<ul>
<li><strong>macOS:</strong> <code>~/.env</code></li>
<li><strong>Windows:</strong> <code>C:\Users\YourUsername\.env</code></li>
</ul>

<p>Content:</p>
<pre><code>HC3_HOST=192.168.1.57
HC3_USER=admin
HC3_PASSWORD=your-password
HC3_PROTOCOL=http</code></pre>

<p><em>Note: Settings configured in the app UI take priority over .env file values.</em></p>

<hr>

<h2>üîÑ Updates</h2>

<p>HomeMap includes automatic update support:</p>
<ul>
<li><strong>Check for Updates:</strong> Menu ‚Üí HomeMap ‚Üí Check for Updates</li>
<li><strong>Automatic Notifications:</strong> App notifies you when new versions are available</li>
<li><strong>One-Click Install:</strong> Download and install updates with a single click</li>
<li><strong>Secure Updates:</strong> All updates are cryptographically signed</li>
</ul>

<p>Updates are downloaded from the <a href="https://github.com/jangabrielsson/HomeMap/releases">GitHub Releases</a> page and verified before installation.</p>

<hr>

<h2>üé® Widget System</h2>

<p>HomeMap uses a flexible JSON-based widget system. Built-in widgets are provided for common device types and automatically synced on startup.</p>

<p><strong>For End Users:</strong> All built-in widgets work out of the box! Simply select a device in the Device Management panel, choose the appropriate widget type, and install it.</p>

<p><strong>For Developers:</strong> Custom widgets and icons can be added to the <code>homemapdata/widgets/packages/</code> and <code>homemapdata/icons/packages/</code> folders. The <code>built-in/</code> folders are automatically synced and should not be edited.</p>

<p>Each widget defines:</p>
<ul>
<li><strong>State:</strong> Device properties to track</li>
<li><strong>Events:</strong> JSONPath patterns for HC3 event matching</li>
<li><strong>Render:</strong> Icon sets, badges, and dynamic styling</li>
<li><strong>Actions:</strong> HC3 API calls for device control</li>
<li><strong>UI:</strong> Interactive dialogs for device control</li>
</ul>

<p>Example widget structure:</p>
<pre><code>{
  "id": "binarySwitch",
  "name": "Binary Switch",
  "type": "com.fibaro.binarySwitch",
  
  "state": {
    "value": false
  },
  
  "events": {
    "value": {
      "match": "$[?(@.property=='value')]",
      "update": "newValue"
    }
  },
  
  "render": {
    "icon": {
      "set": "light",
      "template": "value ? 'on' : 'off'"
    },
    "badge": {
      "template": "value ? 'ON' : 'OFF'"
    }
  },
  
  "actions": {
    "turnOn": {
      "method": "POST",
      "api": "/api/devices/${id}/action/turnOn"
    }
  },
  
  "ui": {
    "type": "toggle",
    "property": "value",
    "onAction": "turnOn",
    "offAction": "turnOff"
  }
}</code></pre>

<p><strong>Advanced Features (v0.1.7+):</strong></p>
<ul>
<li>Expression evaluation in templates (<code>${value * 1.8 - 90}</code>)</li>
<li>SVG manipulation for dynamic graphics</li>
<li>Conditional updates with OR logic</li>
<li>Composable UI with buttons, sliders, and color pickers</li>
<li>Dynamic styling for colored effects</li>
</ul>

<p>See <a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/WIDGET_FORMAT.md">WIDGET_FORMAT.md</a> for complete specification and examples.</p>

<hr>

<h2>üõ†Ô∏è Development</h2>

<p>Built with:</p>
<ul>
<li><strong>Tauri 2.x</strong> - Modern desktop framework</li>
<li><strong>Rust</strong> - Backend for HC3 API integration</li>
<li><strong>JavaScript</strong> - Frontend with vanilla JS</li>
<li><strong>Event-driven</strong> - Long-polling with dispatch tables</li>
</ul>

<p>See <a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/DEVELOPMENT.md">DEVELOPMENT.md</a> for development setup.</p>

<hr>

<h2>üìö Documentation</h2>

<p><strong>For Users:</strong></p>
<ul>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/CONFIGURE.md">CONFIGURE.md</a></strong> - Complete configuration guide</li>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/CHANGELOG.md">CHANGELOG.md</a></strong> - Version history and changes</li>
</ul>

<p><strong>For Developers:</strong></p>
<ul>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/CUSTOM_ICONS.md">CUSTOM_ICONS.md</a></strong> - Creating custom icons</li>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/WIDGET_FORMAT.md">WIDGET_FORMAT.md</a></strong> - Widget JSON format specification</li>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/DEVELOPMENT.md">DEVELOPMENT.md</a></strong> - Development setup guide</li>
<li><strong><a href="https://github.com/jangabrielsson/HomeMap/blob/main/docs/DEV_GUIDE.md">DEV_GUIDE.md</a></strong> - Development patterns</li>
</ul>

<hr>

<h2>üèóÔ∏è Architecture</h2>

<p>Built on Tauri 2.x with:</p>
<ul>
<li><strong>Backend:</strong> Rust for HC3 API integration and file operations</li>
<li><strong>Frontend:</strong> Vanilla JavaScript with Tauri APIs</li>
<li><strong>Event System:</strong> Long-polling with dispatch table (30s timeout, 1s throttle)</li>
<li><strong>Configuration:</strong> JSON-based with auto-save on edits</li>
<li><strong>Based on:</strong> QuickAppManager architecture and learnings</li>
</ul>

<hr>

<h2>ü§ù Contributing</h2>

<p>Contributions are welcome! Please feel free to:</p>
<ul>
<li>Report bugs or request features via <a href="https://github.com/jangabrielsson/HomeMap/issues">Issues</a></li>
<li>Submit pull requests</li>
<li>Share your widget definitions</li>
<li>Improve documentation</li>
</ul>

<hr>

<h2>üìÑ License</h2>

<p>MIT License - see <a href="https://github.com/jangabrielsson/HomeMap/blob/main/LICENSE">LICENSE</a> file for details.</p>

<hr>

<h2>üîó Related Projects</h2>

<ul>
<li><strong><a href="https://github.com/jangabrielsson/EventLogger">EventLogger</a></strong> - HC3 event monitoring tool</li>
<li><strong><a href="https://github.com/jangabrielsson/plua">plua</a></strong> - Lua programming environment for HC3</li>
</ul>

<p><em>HomeMap - Visualize and control your smart home with interactive floor plans! üè†‚ú®</em></p>
    </div>

    <script>
        function copyToClipboard() {
            const content = document.getElementById('content');
            const range = document.createRange();
            range.selectNode(content);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            
            try {
                document.execCommand('copy');
                const button = document.getElementById('copyBtn');
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.style.background = '#2196F3';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#4CAF50';
                }, 2000);
            } catch (err) {
                alert('Copy failed. Please select and copy manually.');
            }
            
            window.getSelection().removeAllRanges();
        }
    </script>
</body>
</html>
